window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.addroom.js'] = (new Date()).getTime();
Type.registerNamespace("_adr");_adr.w=function(){};_adr.w.a=function(n,t,i,r){i.val=new _j.l;r.val=new _a.S;for(var u=0;u<n.length;u++){var e;var f=n[u].ResponseMessage||(e=new _g.gp,e.ResponseCode="NoError",e);var s=new _adr.f(t.c(u),f.ResponseCode);s.eU(n[u]);i.val.a(s);if(f.ResponseCode==="NoError"){var o=n[u].CalendarView.WorkingHours;r.val.b(o?new _g.cp(o):null)}else{r.val.b(null);_j.e.b(_a.a.D,"Failed to get Free busy info. User:{0} Error:{1}",t.c(u),f.MessageText)}}};_adr.w.b=function(n,t,i){i.val=new _j.l;for(var r=0;r<n.length;r++){var u;var e=n[r].ResponseMessage||(u=new _cz.dK,u.ResponseCode="NoError",u);var f=new _adr.f(t.c(r),e.ResponseCode);f.eU(n[r]);i.val.a(f)}};_adr.b=function(n){_adr.b.initializeBase(this);n&&this.eU(n)};_adr.b.$$cctor=function(){_adr.b.c.b(new _a.bB(_dg.a));_a.n.d(_adr.b,_cz.eo,function(n){return new _adr.b(n)})};_adr.b.prototype={b:function(){return this.eH(_adr.b.b)},a:function(){return this.eH(_adr.b.c)},c:function(){return this.eH(_adr.b.a)}};_adr.f=function(n,t){_adr.f.initializeBase(this);this.b=n;this.c=t};_adr.f.b=function(n){if(_j.h.b(n))throw Error.argument("userIdentifier","userIdentifier is null or empty");var t=new _adr.f(n,"NoError");t.d(new _adr.b);t.a().eF(_adr.b.c,new _j.l);t.a().eF(_adr.b.b,"");t.a().eF(_adr.b.a,"None");return t};_adr.f.c=function(n,t){var i=_adr.f.b(n.b);i.a().eF(_adr.b.a,n.a().c());i.a().eF(_adr.b.b,n.a().b());for(var u=0;u<n.a().a().x.length;u++){var r=n.a().a().x[u];var f=new _h.l(r.a(),r.b());if(_h.l.a(t,f))i.a().a().a(r);else if(f.a.b(t.b)>0)break}return i};_adr.f.prototype={b:null,c:"NoError",a:function(){return this.eH(_adr.f.a)},d:function(n){this.eF(_adr.f.a,n);return n}};_adr.H=function(n,t){this.d=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.h);this.a=n;this.b=t;this.g();this.i()};_adr.H.prototype={b:null,a:null,c:null,e:0,g:function(){var n=new _g.Q;n.NotificationType="GetUserAvailabilityNotification";n.ChannelId=_no.a.a;this.c=new _h.I(n);this.c.l(_a.a.G,"GetUserAvailabilityAction",this.f,2)},i:function(){this.a.a(this.d)},h:function(n){if(n.EventType!=="Reload"){var u=n;if(u){var o=u.UserAvailabilityResponses;var r=new _a.S;r.j(u.EmailAddresses);if(o&&r){var t;var i;var e,f;_adr.w.a(o,r,e={val:t},f={val:i}),t=e.val,i=f.val;if(this.b){this.b(t,i,this.a,!1);this.e+=t.x.length}}}}},j:function(n){this.c.o();this.a.m(this.d)}};_adr.F=function(){_adr.F.initializeBase(this);this.f=new _cz.hn(this.L)};_adr.F.prototype={f:null,e:null,cI:function(n){this.e=n.RoomLists?n.RoomLists:new Array(0)},K:function(n){var t=new _cz.dm(this.M());n.cn(t,this.f,this.J,this.H)}};_adr.z=function(n,t,i,r,u){this.o=this.e;_adr.z.initializeBase(this);if(!u||!u.a.length)throw Error.argument("requestedUsers","requestedUsers array is either null or empty");this.s=i;this.k=u;this.t=r;this.q=n;this.l=t};_adr.z.prototype={k:null,q:null,l:null,t:0,s:"None",p:null,u:null,h:function(){return this.p},j:function(){return this.q},f:function(){return this.l},e:function(){return this.k},E:function(){return this.u},Y:function(){return _g.a.a().C||_h.ch.prototype.Y.call(this)},K:function(n){for(var u=new _cz.w(this.M()),r=new Array(this.k.a.length),t=0;t<this.k.a.length;t++){r[t]=new _dg.bA;r[t].Email=new _dg.bw;r[t].Email.Address=this.k.c(t)}var i=new _cz.v;i.MergedFreeBusyIntervalInMinutes=this.t;i.RequestedView=this.s;i.TimeWindow=new _cz.m(_a.d.d(this.q),_a.d.d(this.l));u.Body.MailboxDataArray=r;u.Body.FreeBusyViewOptions=i;var f=new _cz.dx(this.L);n.i(u,f,this.J,this.H)},cI:function(n){var i;var t;var u,r;_adr.w.a(n.Responses,this.k,u={val:i},r={val:t}),i=u.val,t=r.val;this.p=i;this.u=t}};_adr.G=function(){_adr.G.initializeBase(this);this.h=new _dg.dl(this.L)};_adr.G.prototype={h:null,f:null,e:null,Y:function(){return _g.a.a().C||_h.ch.prototype.Y.call(this)},cS:function(n,t,i){this.e=new Array(n.length);for(var r=0;r<n.length;r++)this.e[r]=n[r].Id;t()},K:function(n){var t=this.f?this.f.EmailAddress:null;n.co(t,this.h,this.J,this.H)}};_adr.J=function(){};_adr.J.prototype={a:function(n,t){var i=n;switch(i){case"Accept":return _adrs.CalARStrings.BP;case"Tentative":return _adrs.CalARStrings.x;case"Decline":return _adrs.CalARStrings.l;case"Unknown":case"NoResponseReceived":return _adrs.CalARStrings.BQ;case"Organizer":default:return""}},b:function(n,t){throw Error.notImplemented();}};_adr.I=function(){};_adr.I.prototype={a:function(n,t){var i=n;switch(i){case"Accept":case"Tentative":return _adrs.CalARStrings.H;case"Decline":return _adrs.CalARStrings.BZ;case"Unknown":case"NoResponseReceived":return _adrs.CalARStrings.BQ;case"Organizer":default:return""}},b:function(n,t){throw Error.notImplemented();}};_adr.R=function(){};_adr.R.registerInterface("_adr.R");_adr.S=function(){};_adr.S.registerInterface("_adr.S");_adr.B=function(){};_adr.B.prototype={singleDay:0,week:1,threeDay:2};_adr.B.registerEnum("_adr.B",!1);_adr.c=function(n,t,i,r,u){this.A=Function.createDelegate(this,this.bf);this.H=Function.createDelegate(this,this.bg);this.J=Function.createDelegate(this,this.bh);this.C=new Sys.EventHandlerList;this.D=new _a.S;_adr.c.initializeBase(this);_a.b.b(r,"itemViewModel");_a.b.b(n,"gridUserAvailabilityCoordinator");_a.b.b(t,"detailsUserAvailabilityCoordinator");this.B=i;this.t=n;this.u=t;this.x=u;this.y=this.Y();this.T=_adr.c.a(r.h,null);this.L=new _cc.bl;var f=_cc.a.z(r.h);this.S=f.a;this.R=f.b;this.d(r.b.a());this.Q=r.b.bs();this.P=r.b.h();this.t.g(this.J);this.u.g(this.H);this.t.apcl("HasActiveRequests",this.A);this.u.apcl("HasActiveRequests",this.A)};_adr.c.b=function(n){return n==="Tentative"||n==="Busy"||n==="OOF"};_adr.c.a=function(n,t){var f={};var r;r=_cc.a.c(n)&&n.C()==="Exception"?new _adr.I:new _adr.J;var h=n.bD.Organizer;h?f[h.Mailbox.EmailAddress]=r.a("Organizer",null):_j.e.a(_a.a.bN,"ComposeUserAvailabilityProvider: CreateResponseTrackingMap: Skipping adding organizer entry since organizer is null for "+(n.cM()?"full":"partial")+" calendar item, with ItemID "+n.bD.ItemId+". RequiredAttendees.Count = "+n.v().b()+". OptionalAttendees.Count = "+n.t().b()+". Resources.Count = "+n.M().b()+". IsOrganizer = "+n.bD.IsOrganizer);if(n.bD.ItemId){for(var i=null,u=n.v().b(),o=0;o<u;o++){i=n.v().a(o);f[i.bD.Mailbox.EmailAddress]=t||r.a(i.b(),null)}u=n.t().b();for(var e=0;e<u;e++){i=n.t().a(e);f[i.bD.Mailbox.EmailAddress]=t||r.a(i.b(),null)}u=n.M().b();for(var s=0;s<u;s++){i=n.M().a(s);f[i.bD.Mailbox.EmailAddress]=t||r.a(i.b(),null)}}return f};_adr.c.d=function(n,t){for(var u=t.a().a(),f=new _a.S,i=0;i<u.x.length;++i){var r=new _adr.m(u.x[i]);n.e(r)&&_adr.c.b(r.d)&&f.b(r)}return f};_adr.c.e=function(n,t){for(var u=new _a.S,i=0;i<t.a.length;++i){var r=t.c(i);n.e(r)&&_adr.c.b(r.d)&&u.b(r)}return u};_adr.c.prototype={t:null,u:null,L:null,B:0,S:null,R:null,y:null,T:null,x:null,Q:!1,P:!1,v:null,w:null,G:null,O:!1,E:null,e:function(n){this.t.g(n)},c:function(n){this.t.i(n)},k:function(n){this.C.addHandler("DetailsCacheUpdateEvent",n)},p:function(n){this.C.removeHandler("DetailsCacheUpdateEvent",n)},q:function(n){if(!_a.d.c(this.G,n)){if(n.F())throw Error.argument("MeetingStartDate","value should not contain time part.");this.G=n;this.u.r(this.G,null)}return n},i:function(){return this.w},d:function(n){if(!_a.d.c(this.w,n)){this.w=n;if(this.t.k(n))return n;var t=this.E.d(!1);var i=_a.d.e(n);this.bj(t);this.t.r(i,t)}return n},bi:function(n){if(this.O!==n){this.O=n;this.bw("IsLoadingData")}return n},a:function(){return this.E},f:function(n){this.E=n;return n},m:function(){return this.v},g:function(n){this.v=n;return n},l:function(){return this.D},n:function(n,t){var r=null;var i=null;t=t.i();var f,u;this.be(n,t,f={val:i},u={val:r}),i=f.val,r=u.val;return this.ba(this.B,i,r,t.a.length)},r:function(n){for(var r=this.t.b(n),u={},t=0;t<r.a.length;t++){var i=r.c(t);u[i.b]=i.c}return u},s:function(n,t,i){var a=new _h.l(n,t);var f={};var e=i.i();if(this.v&&e.g(this.v.EmailAddress)){e.e(this.v.EmailAddress);for(var c=this.K(this.v.EmailAddress,this.D,a),v=new _a.S,s=0;s<c.a().a().x.length;s++)v.b(new _adr.m(c.a().a().x[s]));f[c.b]=v}for(var y=this.t.b(e),o=0;o<y.a.length;o++){var r=y.c(o);var u=null;switch(r.a().c()){case"None":break;case"MergedOnly":u=this.W(r);break;default:u=new _a.S;for(var l,h=0;h<r.a().a().x.length;h++){l=new _adr.m(r.a().a().x[h]);a.e(l)&&u.b(l)}break}f[r.b]=u}var p=this;i.h(function(n){!f[n]});return f},o:function(n,t,i,r){var u=new _h.l(n,t);if(_h.l.a(this.t.a,u)){if(this.t.w(i))return!0;r&&this.t.b(i)}else{if(this.u.w(i))return!0;r&&this.u.b(i)}return!1},b:function(n,t,i,r){var f=new _h.l(n,t);var c=i.i();var l=null;if(r&&this.v&&c.g(this.v.EmailAddress)){c.e(this.v.EmailAddress);l=this.K(this.v.EmailAddress,this.D,f)}var a=this.bd(f,c);l&&a.b(l);for(var e={},h=0;h<a.a.length;h++){var u=a.c(h);var s=null;var o="Free";switch(u.a().c()){case"None":o="NoData";break;case"MergedOnly":s=_adr.c.e(f,this.W(u));o=this.bc(f,s);break;default:s=_adr.c.d(f,u);o=this.bb(f,u);break}e[u.b]=this.N(u.b,n,t,u.c,o,s)}var v=this;i.h(function(i){e[i]||(e[i]=v.N(i,n,t))});return e},j:function(){_j.e.a(_a.a.bN,"Refreshing Scheduling Grid Cache...");this.Z();var n=this.E.d(!0);this.t.y(n,!0);if(!this.t.a.d(this.u.a,!0)){_j.e.a(_a.a.bN,"Refreshing Scheduling Details Cache...");this.u.y(n,!0)}},h:function(n){this.t.o(n);this.u.o(n);this.j()},bx:function(){this.t.i(this.J);this.u.i(this.H);this.t.rpcl("HasActiveRequests",this.A);this.u.rpcl("HasActiveRequests",this.A);_j.R.prototype.bx.call(this)},K:function(n,t,i){for(var r=_adr.f.b(n),w=this.t.b(t),e=[],a=0;a<w.a.length;a++){var u=w.c(a);if(e.length)if(u.a().b())for(var f=0;f<e.length;f++)u.a().b().charAt(f)<e[f]&&(e[f]=u.a().b().charAt(f));else _j.e.b(_a.a.bN,"MergedFreeBusy property for a room was null");else if(u.a().b())for(var y=0;y<u.a().b().length;y++)Array.add(e,u.a().b().charAt(y));else _j.e.b(_a.a.bN,"MergedFreeBusy property for a room was null")}r.a().eF(_adr.b.b,e.join(""));r.a().eF(_adr.b.a,"FreeBusyMerged");if(i){var s;var v;var p,b;this.M(this.B,p={val:s},b={val:v}),s=p.val,v=b.val;for(var k=this.B===1?_a.d.e(this.w).d():this.w.d(),l=k.v(),h,o=s;o<v&&r.a().b().length>0;o++){h=k.o((o-s+1)*this.x.a().bD.HourIncrement);var d=new _h.l(l,h);if(_adr.c.b(this.z(r,o))&&_h.l.a(d,i)){var c=new _dg.a;c.bu(l);c.R(h);c.cq(this.z(r,o));r.a().a().a(c)}l=h}}return r},W:function(n){var e=new _a.S;var t;var i;var h=1440/this.x.a().bD.HourIncrement;var f;if(n.a().b().length===h){t=0;i=h;f=this.u.a.a}else{var l,c;this.M(0,l={val:t},c={val:i}),t=l.val,i=c.val;f=this.w}for(var o=t,u=this.z(n,t),r=t+1;r<i;r++){var s=this.z(n,r);if(s!==u){this.U(e,f,u,t,o,r);o=r;u=s}}this.U(e,f,u,t,o,i);return e},U:function(n,t,i,r,u,f){if(i!=="Free"){var o=(f-u)*this.x.a().bD.HourIncrement;var e=new _dg.a;e.bu(t.d().o((u-r)*this.x.a().bD.HourIncrement));e.R(e.a().o(o));e.cq(i);n.b(new _adr.m(e))}},bb:function(n,t){for(var r="Free",e=this.y.Free,u=0;u<t.a().a().x.length;u++){var i=t.a().a().x[u];if(n.e(i)){var f=this.y[i.m()];if(f>e){e=f;r=i.m()}if(r===_adr.c.c)break}else if(i.a().b(n.b)>0)break}return r},bc:function(n,t){for(var r="Free",e=this.y.Free,u=0;u<t.a.length;u++){var i=t.c(u);if(n.e(i)){var f=this.y[i.d];if(f>e){e=f;r=i.d}if(r===_adr.c.c)break}else if(i.L.b(n.b)>0)break}return r},bd:function(n,t){var i;if(_h.l.a(this.t.a,n)){_j.e.a(_a.a.bN,"Fetching free-busy information for attendees from grid cache...");i=this.t.b(t)}else i=this.u.b(t);return i},bh:function(n){if(this.t.a.d(this.u.a,!0)){_j.e.a(_a.a.bN,"[Grid] Fire details cache event. Grid:{0} - Detail{1}",this.t.a,this.u.a);this.V(n)}else _j.e.a(_a.a.bN,"[Grid] Suppress detail cache event. Grid:{0} - Detail{1}",this.t.a,this.u.a)},bg:function(n){if(this.t.a.d(this.u.a,!0))_j.e.a(_a.a.bN,"[Detail] Suppressing details cache event. Grid:{0} - Detail{1}",this.t.a,this.u.a);else{_j.e.a(_a.a.bN,"[Detail] Fire details cache event. Grid:{0} - Detail{1}",this.t.a,this.u.a);this.V(n)}},V:function(n){var t=this.C.getHandler("DetailsCacheUpdateEvent");t&&t(n)},Z:function(){var n=this.C.getHandler("CacheRefreshRequested");n&&n()},be:function(n,t,i,r){i.val=null;_j.h.a(n)||t.b(n);var f=t.i();var e=null;if(this.v&&f.g(this.v.EmailAddress)){f.e(this.v.EmailAddress);e=this.K(this.v.EmailAddress,this.D,null)}r.val=this.t.b(f);e&&r.val.b(e);for(var u=0;u<r.val.a.length;){if(r.val.c(u).b===n){_j.e.a(_a.a.bN,"Found organizer{0} free busy model",r.val.c(u).b);i.val=r.val.c(u);r.val.k(u);continue}u++}},ba:function(n,t,i,r){var l=new _j.l;var f;var s;var a,p;this.M(n,a={val:f},p={val:s}),f=a.val,s=p.val;for(var v=n===1?_a.d.e(this.w).d():this.w.d(),y=v.v(),o,u=f;u<s;u++){var e=0;var c=this.z(t,u);_adr.c.b(c)&&e++;for(var h=0;h<i.a.length;h++)_adr.c.b(this.z(i.c(h),u))&&e++;o=v.o((u-f+1)*this.x.a().bD.HourIncrement);e>0&&l.a(new _adr.l(c,this.X(e,r),y,o,this.Q,this.P));y=o}return l},M:function(n,t,i){var u=null;var f=0;var r=1440/this.x.a().bD.HourIncrement;switch(n){case 0:u=this.w.d();break;case 1:u=_a.d.e(this.w).d();r=r*7;break;case 2:u=this.w.d();r=r*3;break;default:throw Error.notImplemented(_adr.B.toString(n));}f=Math.abs(this.t.a.a.e(u));var e=6e4*this.x.a().bD.HourIncrement;t.val=f/e;i.val=t.val+r},z:function(n,t){if(!n||_j.h.a(n.a().b()))return"NoData";else{var i=n.a().b().charAt(t).toString();switch(i){case"0":return"Free";case"1":return"Tentative";case"2":return"Busy";case"3":return"OOF";case"4":return"WorkingElsewhere";case"5":return"NoData";default:_j.e.c(_a.a.bN,"Unexpected merged string encountered:'{0}')",i);return"NoData"}}},X:function(n,t){if(!t)return 0;var i=n/t;if(i>.9&&i<1)return.9;else if(i>0&&i<.15)return.15;return i},N:function(n,t,i,r,u,f){var o;var e;var h=!1;if(_j.u.a(u)){o="NoData";e=_u.R.Nw;r="NoError"}else{o=u;e=this.L.a(o,null)}if(this.S.B(t)&&this.R.B(i)){var s=this.T[n];if(s){h=!0;e=s}}return new _adr.d(n,o,e,h,r,f)},Y:function(){var n={};n.Free=0;n.WorkingElsewhere=1;n.Tentative=2;n.Busy=3;n.OOF=4;return n},bf:function(n,t){this.bi(this.t.f||this.u.f)},bj:function(n){if(_h.l.a(this.t.a,this.u.a)){var t=this.t.b(n);this.u.D(t);if(t.a.length!==n.a.length){for(var u=new _a.S,e={},i=0;i<t.a.length;i++)e[t.c(i).b]=!0;for(var r=0;r<n.a.length;r++){var f=n.c(r);e[f]||u.b(f)}_j.e.a(_a.a.bN,"Requesting FB for missing effective users {0}",u);this.u.b(u)}}}};_adr.C=function(n,t,i,r,u){this.t=Function.createDelegate(this,this.B);this.h=new Sys.EventHandlerList;_adr.C.$$(this.$$gta["_adr.C"].T).initializeBase(this);if(!t)throw Error.argumentNull("submitter");this.q=t;this.l=r;this.m=i;this.e=u;this.d={};this.c=new _a.S;this.u(n)};_adr.C.$$=function(n){var u=_adr.__tc=_adr.__tc||{};var t="C"+"$"+n.getName().replace(/\./g,"_");if(!u[t]){var r=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_adr.C.apply(this,t)};var o=_j.R;r.registerClass("_adr.__tc."+t,o);var s={"_adr.C":{T:n},ctor:_adr.C};r.prototype.$$gta=s;var e=_adr.C.prototype;for(var f in e){var i={key:f,value:e[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return u[t]};_adr.C.prototype={c:null,m:0,l:0,q:null,e:null,a:null,d:null,f:!1,g:function(n){this.h.addHandler("CacheUpdateEventName",n)},i:function(n){this.h.removeHandler("CacheUpdateEventName",n)},p:function(n){if(this.f!==n){this.f=n;this.bw("HasActiveRequests")}return n},k:function(n){return this.a.c(n,!0,!1)},r:function(n,t){if(!this.k(n)){this.o(n);t&&this.n(t)}},D:function(n){for(var t=0;t<n.a.length;t++){var i=n.c(t);this.d[i.b]=_adr.f.c(i,this.a)}},w:function(n){for(var t=0;t<n.a.length;t++){var i=this.d[n.c(t)];if(!i)return!1}return!0},b:function(n){for(var r=new _a.S,u=new _a.S,t=0;t<n.a.length;t++){var i=this.d[n.c(t)];i?r.b(i):u.b(n.c(t))}this.n(u);return r},o:function(n){this.d={};this.c.f();this.p(!1);this.u(n)},n:function(n){this.C(n);if(n.a.length<=0){_j.e.a(this.e,"No FB requests needed after removing redundant user identifiers.");return}_j.e.a(this.e,"Requesting FB:{0} - {1}",this.a,n.toString());var t=this.A(n);t.a(this.t);this.c.b(t);this.q.a(t);this.p(this.c.a.length>0)},v:function(n,t,i,r){if(!this.c.g(t)){_j.e.a(this.e,"Discarding FB results {0}-{1} {2} ",t.j(),t.f(),t.e());return}i&&this.c.e(t);for(var e=new _a.S,f=0;f<n.x.length;f++){var u=n.x[f];e.b(u.b);var o=this.d[u.b];o&&u.a().c()==="None"||(this.d[u.b]=u)}r&&r(e);this.p(this.c.a.length>0);this.z(e)},u:function(n){var i=n.c(-this.m).d();var t=n.c(this.l).d();i.B(t)&&(t=t.c(1));this.a=new _h.l(i,t);_j.e.a(this.e,"CreateNewCacheRange: Range:{0}",this.a)},C:function(n){for(var t=0;t<this.c.a.length;t++){var i=this.c.c(t);var r=this;i.e().h(function(t){n.e(t)});if(!n.a.length)return}},B:function(n){var t=n;var i=t.h();if(t.G){_j.e.b(this.e,"{0} failed with the following error {1}",t.be,t.G.message);i=new _j.l;var r=this;t.e().h(function(n){i.a(_adr.f.b(n))})}this.v(i,t,!0,null)},z:function(n){var t=this.h.getHandler("CacheUpdateEventName");t&&t(n)}};_adr.i=function(n,t,i,r,u,f,e){_adr.i.initializeBase(this,[n,t,i,r,u,f,e]);this.Z.g(!0)};_adr.l=function(n,t,i,r,u,f){_adr.l.initializeBase(this);this.g=i?i.v():null;this.l=r?r.v():null;this.c=n;this.t=t;this.d=_dg.c.a("");this.p=u;this.o=f};_adr.l.prototype={d:null,t:0,g:null,l:null,c:"Free",p:!1,o:!1,h:function(){return this.o},bs:function(){return this.p},j:function(){return null},E:function(){return!1},a:function(){return this.g},q:function(){return!1},b:function(){return this.l},n:function(){return""},m:function(){return this.c},D:function(){return!1},u:function(){switch(this.c){case"Tentative":case"Busy":case"OOF":return!1;default:return!0}},e:function(){return null},i:function(){return""},z:function(){return this.d},r:function(){return"None"},H:function(){return!1},G:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingConflictViewModel");},s:function(){throw Error.notImplemented("The OrganizerName property is not supported in SchedulingConflictViewModel");},B:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingConflictViewModel");},f:function(){return null},C:function(){return"Unspecified"},bt:function(){return this.d.c()}};_adr.m=function(n){this.x=this.s;this.u=this.r;this.y=this.a;this.v=this.C;_adr.m.initializeBase(this);this.Q=new _g.e(null);this.L=n.a();this.M=n.b();this.d=n.m();this.K=n.n();this.J=n.z()?n.z():_dg.c.a("");if(_j.h.a(this.K)){var t=new _cc.bl;this.N=t.a(this.d,null)}else this.N=this.K;n.a()&&n.b()&&(this.P=n.bs());this.O=new _adr.m.b(this)};_adr.m.a=function(n,t){var i=new _adr.m(n);i.t=n.t;var r=_cc.a.A(t,n);i.L=r.a;i.M=r.b;return i};_adr.m.prototype={J:null,N:null,d:"Free",K:null,Q:null,P:!1,t:null,L:null,M:null,j:function(){return this.Q},E:function(){return!1},q:function(){return!1},h:function(){return this.M.e(this.L)>=864e5},bs:function(){return this.P},D:function(){return!1},o:function(){return!1},l:function(){return!1},c:function(){return!1},w:function(){return!1},p:function(){return!1},g:function(){return!1},s:function(){return""},z:function(){return this.J},r:function(){return"None"},O:null,A:function(){return this.O},a:function(){return this.L},b:function(){return this.M},n:function(){return this.N},m:function(){return this.d},e:function(){return this.t},i:function(){return""},H:function(){return!1},G:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingItemViewModel");},B:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingItemViewModel");},f:function(){return null},C:function(){return"Unspecified"},bt:function(){return this.J.c()}};_adr.m.b=function(n){this.f=n.N;this.d=n.J?n.J.c():null;this.e=""};_adr.m.b.prototype={f:null,c:function(){return this.f},d:null,a:function(){return this.d},e:null,b:function(){return this.e}};_adr.D=function(n,t,i,r,u,f){this.x=Function.createDelegate(this,this.G);_adr.D.initializeBase(this,[n,t,r,u,_a.a.ef]);this.s=i;this.j=f};_adr.D.prototype={j:null,s:null,y:function(n,t){if(t){var i={};var r=this;n.h(function(n){var t=r.d[n];t&&(i[n]=t)});this.d=i}this.n(n)},A:function(n){var t=new _adr.z(this.a.a,this.a.b,"DetailedMerged",this.s.a().bD.HourIncrement,n);var r=this.E(t);this.j.g().d(t);var i=this;t.a(function(n){i.J(n,r)});return t},E:function(n){return new _adr.H(n,this.x)},G:function(n,t,i,r){var u=this;this.v(n,i,r,function(n){u.H(n,t)})},H:function(n,t){t&&this.j.g().k(n,t)},J:function(n,t){var r=_a.c.b(_a.a.ef,"Scheduling.UserAvailabilityActionCompleted",!1,null);var u=n;var i=new _a.l;i.a("RU",u.k.a.length);t&&i.a("SU",t.e);r.l=i.toString();_a.c.a(r)}};_adr.h=function(n,t){this.c=n;this.a=t};_adr.h.prototype={c:null,a:null,b:function(n,t,i){var u=this.e(n.b.a(),t);var r=this.d(n.b.a(),t);return new _adr.c(u,r,i,n,this.a)},e:function(n,t){return new _adr.D(_a.d.e(n),_a.g.a,this.a,7,14,t)},d:function(n,t){return new _adr.D(n,_a.g.a,this.a,0,0,t)}};_adr.d=function(n,t,i,r,u,f){_adr.d.initializeBase(this);this.b=t;this.g=n;this.h=r;this.i=u;this.d=i;this.c=f;this.a=this.j()};_adr.d.a=function(n){var r=new _j.l;var u=n;for(var t in u){var i={key:t,value:u[t]};var f=i.value;f.e()&&r.a(i.value)}return r};_adr.d.c=function(n,t){var u=t?_adrs.CalARStrings.u:_adrs.CalARStrings.z;var r=t?_adrs.CalARStrings.S:_adrs.CalARStrings.BB;var i=t?_adrs.CalARStrings.BF:_adrs.CalARStrings.BC;switch(n){case 0:return u;case 1:return r;default:return String.format(i,n)}};_adr.d.b=function(n,t){var u=t?_adrs.CalARStrings.BA:_adrs.CalARStrings.BX;var r=t?_adrs.CalARStrings.BV:_adrs.CalARStrings.a;var i=t?_adrs.CalARStrings.BS:_adrs.CalARStrings.i;switch(n){case 0:return u;case 1:return r;default:return String.format(i,n)}};_adr.d.f=function(n){return String.format(_a.bH.e(n,_adrs.CalARStrings.R,_adrs.CalARStrings.T,_adrs.CalARStrings.Y),n)};_adr.d.e=function(n){return String.format(_adrs.CalARStrings.w,n)};_adr.d.d=function(n){return String.format(_adrs.CalARStrings.Bc,n)};_adr.d.prototype={b:"Free",g:null,d:null,a:null,h:!1,i:"NoError",c:null,f:null,e:function(){return this.h?!1:_adr.c.b(this.b)},j:function(){var i="";if(this.e()&&this.c){var t=this.c.a.length;if(t>1)i=String.format(_adrs.CalARStrings.O,t);else if(t===1){var n=this.c.c(0);n&&!_j.h.a(n.K)&&(i=n.K)}}return i}};function CalendarAddRoomComponent(){}CalendarAddRoomComponent.$$cctor=function(){_a.t.a().a(CalendarAddRoomComponent)};CalendarAddRoomComponent.prototype={b:function(n,t,i){var e=this;n.b(_adr.v,function(){return new _adr.v(n.a(_adr.q),n.a(_adr.h),n.a(_adr.r),n.a(_y.a),n.a(_adr.i),n.a(_a.f),n.a(_g.h),n.a(_a.r))}).a();var o=this;n.b(_adr.t,function(){return new _adr.t(n.a(_adr.q),n.a(_y.a))}).a();var s=this;n.b(_adr.q,function(){return new _adr.q(n.a(_a.r),n.a(_g.a).b(),n.a(_y.a),n.a(_a.f),n.a(_j.o),i.a()==="TouchNarrow"?n.a(_y.r):null)}).a();var r=this;n.b(_adr.h,function(){return new _adr.h(n.a(_y.a),n.a(_g.a))}).a();var u=this;n.b(_adr.r,function(){return new _adr.r(n.a(_a.r))}).a();var f=this;n.b(_adr.i,function(){var t=new _cc.CalendarsCacheInternal;return new _adr.i(n.d(_cc.bf),n.a(_dg.bM),n.a(_dg.cl),t,n.a(_a.f),n.a(_g.h),n.a(_a.r))})},a:function(){return[]}};_adr.v=function(n,t,i,r,u,f,e,o){this.d=n;this.f=t;this.c=i;this.b=r;this.a=f;this.h=e;this.g=o;this.e=u};_adr.v.prototype={f:null,c:null,d:null,b:null,e:null,a:null,h:null,g:null,i:function(n){var e=this.b.a()==="TouchNarrow"?0:1;var t=this.f.b(n,this.e,e);var r=this.c.c(n,t);var i=this.c.b(n,t,r);t.f(i);var f=!!this.a&&this.a.a().iC().Enabled;var u=this.d.h(i,r,f);return new _adr.E(n.b,t,i,u,this.b)}};_adr.E=function(n,t,i,r,u){this.r=Function.createDelegate(this,this.J);this.l=Function.createDelegate(this,this.H);this.s=Function.createDelegate(this,this.K);_adr.E.initializeBase(this,[t,i,r,u]);this.c=n;this.e=this.d.a();this.o="AddRoom_ComposeForm"};_adr.E.prototype={c:null,e:null,g:null,G:function(n){this.eJ("OnRoomSelectionChanged",n)},A:function(n){if(this.g!==n){this.g&&this.g.q(this.s);this.g=n;this.g&&this.g.p(this.s)}return n},m:function(){if(!this.h){_adr.s.prototype.m.call(this);this.v();this.B()}},y:function(){_adr.s.prototype.y.call(this);this.c.apcl("Start",this.l);this.c.apcl("End",this.l);this.c.apcl("Resources",this.r);this.t()},q:function(){this.u();this.c.rpcl("Start",this.l);this.c.rpcl("End",this.l);this.c.rpcl("Resources",this.r);_adr.s.prototype.q.call(this)},z:function(n,t){_adr.s.prototype.z.call(this,n,t);var i=_cc.a.e(null)?null:this.e;this.e=this.d.a();this.u();i&&this.c.M().b()>0&&this.c.M().a(0).bD.Mailbox.EmailAddress===i.EmailAddress&&this.c.M().o(0);this.e&&this.c.M().r(0,_dg.e.a(this.e));this.t();var r=this.fU("OnRoomSelectionChanged");r&&r(i,this.e)},H:function(n,t){this.B()},B:function(){var n=new _h.l(this.c.a(),this.c.b());this.j.d(this.c.a());this.j.q(this.c.a().d());this.d.i(n)},v:function(){var n=this.c.M();this.E();n&&n.b()>0?this.d.c(n.a(0).bD.Mailbox):this.d.c(null);this.D();this.e=this.d.a();this.x()},J:function(n,t){this.u();this.t();this.v()},K:function(n,t){this.v()},t:function(){this.A(this.c.M())},u:function(){this.A(null)}};_adr.O=function(){};_adr.O.registerInterface("_adr.O");_adr.P=function(){};_adr.P.registerInterface("_adr.P");_adr.Q=function(){};_adr.Q.registerInterface("_adr.Q");_adr.s=function(n,t,i,r){this.w=Function.createDelegate(this,this.z);this.C=Function.createDelegate(this,this.M);_adr.s.initializeBase(this);this.j=n;this.d=t;this.f=i;this.n=r;this.h=!1;this.o="AddRoom_SchedulingAssistant";this.i=new _j.g(this.C,_adr.s.a);this.i.c(!1);this.x()};_adr.s.prototype={n:null,i:null,f:null,p:null,d:null,j:null,O:function(n){if(this.p!==n){this.p=n;this.eI("FindARoomButtonLabel","HideFindARoomControl")}return n},b:function(){return this.i},a:function(){return this.f},N:function(){return this.n.a()==="TouchNarrow"&&this.d.f()},h:!1,o:null,m:function(){if(!this.h){this.y();this.h=!0;this.i.c(!0)}},L:function(){if(this.h){this.q();this.h=!1;this.i.c(!1)}},eG:function(){this.q();var i;_a.h.a(i={val:this.j}),this.j=i.val;var t;_a.h.a(t={val:this.f}),this.f=t.val;var n;_a.h.a(n={val:this.d}),this.d=n.val;_a.gb.prototype.eG.call(this)},y:function(){this.D()},q:function(){this.E()},D:function(){this.d.apcl("SelectedRoomViewModel",this.w)},E:function(){this.d.rpcl("SelectedRoomViewModel",this.w)},x:function(){this.O(this.d.f()?_adrs.CalARStrings.y:_adrs.CalARStrings.v)},z:function(n,t){this.x()},M:function(){_a.c.c(_a.a.x,this.o);this.n.a()==="TouchNarrow"?this.n.f(this.f,0,!1):this.f.c(!0)}};_adr.t=function(n,t){this.a=n;this.b=t};_adr.t.prototype={a:null,b:null,c:function(n,t,i){var r=this.a.i(n,t);return new _adr.s(i,n,r,this.b)}};_adr.N=function(n,t){this.bf=Function.createDelegate(this,this.bx);this.Q=Function.createDelegate(this,this.bw);_adr.N.initializeBase(this);this.T=n;this.f=t;this.s=new Sys.EventHandlerList;this.bh(!0);this.apcl("IsDataLoaded",this.Q);this.apcl("HasErrorOccurred",this.Q);this.z=new _j.g(this.bf,_a.a.G)};_adr.N.prototype={f:null,s:null,z:null,T:null,S:!1,h:!1,t:!1,B:!1,p:0,b:function(n){this.s.addHandler("StepCompleted",n)},e:function(n){this.s.removeHandler("StepCompleted",n)},a:function(){return this.T},bg:function(n){if(this.S!==n){this.S=n;this.eE("IsActive")}return n},A:function(n){if(this.h!==n){this.h=n;this.eI("IsDataLoaded","HasNoRoomsFound")}return n},R:function(){return this.h&&!this.p},bh:function(n){if(this.B!==n){this.B=n;this.eE("ShowLoadingMessage")}return n},o:function(n){if(this.t!==n){this.t=n;this.eE("HasErrorOccurred")}return n},bi:function(n){if(this.p!==n){this.p=n;this.eI("TotalNumberOfItems","HasNoRoomsFound")}return n},c:function(){this.x();this.bg(!0)},d:function(){this.y();this.bg(!1)},i:function(n){var t=this.s.getHandler("StepCompleted");t&&t(n)},bw:function(n,t){this.bh(!this.h&&!this.t)},bx:function(){this.y();this.x()}};_adr.x=function(n,t,i,r,u,f,e){this.o=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.x);this.j=Function.createDelegate(this,this.s);_adr.x.initializeBase(this);this.f={};this.f[n.a()]=n;this.f[t.a()]=t;this.e=n;this.i=i;this.g=!1;this.u=r||"AddRoom_SchedulingAssistant";this.v=u;this.r=f;if(e){var o=e.b();if(this.r.a()){o.b(2);o.d(_adrs.CalARStrings.F);o.e(2);o.c(e.a(_fm.a.b,_fm.a.b,new _j.g(this.j,_a.a.G),_u.c.Dv))}else{o.b(1);o.d(_adrs.CalARStrings.A);o.a(e.a(_y.b.a(),_y.b.a(),new _j.g(this.j,_a.a.G),""))}this.fg(o)}};_adr.x.prototype={i:null,f:null,r:null,e:null,h:null,g:!1,u:null,v:null,a:function(){return this.g},c:function(n){if(this.g===n)return n;this.g=n;this.eE("PopupVisible");this.g?this.p():this.q();return n},b:function(){return this.h},d:function(n){this.h=n;return n},y:function(n){if(this.e!==n){this.e=n;this.eE("CurrentStep")}return n},n:function(){return this.i.a()==="TouchNarrow"?1:0},dw:function(){_y.lw.prototype.dw.call(this);this.p()},dx:function(){this.q();_y.lw.prototype.dx.call(this)},du:function(){_y.lw.prototype.du.call(this)},eG:function(){for(var r=Object.keys(this.f),u=r.length,n=0;n<u;n++){var t=this.f[r[n]];var i;_a.h.a(i={val:t}),t=i.val}_y.lw.prototype.eG.call(this)},s:function(){this.bT().d()},x:function(n){if(_j.h.a(n)){this.i.a()==="TouchNarrow"?this.s():this.c(!1);return}var t=this.f[n];this.z(t)},z:function(n){this.e&&this.q();this.y(n);this.p()},p:function(){this.e.b(this.m);this.e.I(this.o);this.e.c();this.w(this,null)},q:function(){this.e.e(this.m);this.e.F(this.o);this.e.d()},w:function(n,t){null!==this.h&&this.h.a()}};_adr.q=function(n,t,i,r,u,f){this.e=n;this.f=t;this.c=i;this.b=r;this.d=u;this.a=f};_adr.q.prototype={e:null,f:null,c:null,d:null,a:null,b:null,i:function(n,t){var r=this.g(n);var i=new _adr.g(n,t,!1);return new _adr.x(r,i,this.c,"AddRoom_SchedulingAssistant",this.b,this.d,this.a)},h:function(n,t,i){var u=new _adr.L(n,t,i);var r=this.g(n);return new _adr.x(r,u,this.c,"AddRoom_ComposeForm",this.b,this.d,this.a)},g:function(n){var t=this;return new _adr.k(this.e,this.f,n,function(){return new _adr.F})}};_adr.K=function(n,t,i){this.L=Function.createDelegate(this,this.A);this.K=Function.createDelegate(this,this.S);this.J=Function.createDelegate(this,this.R);this.H=Function.createDelegate(this,this.Q);this.G=Function.createDelegate(this,this.P);_adr.K.initializeBase(this);this.q=n;this.q.e(this.G);this.x=t;this.apcl("SelectedDateRange",this.H);this.apcl("selectedRoomEmailAddress",this.J);this.C=new _j.g(this.K,_a.a.b);this.z=new _j.g(this.L,_a.a.b,this.v());this.s=new _g.f;this.s.Name=_adrs.CalARStrings.d;this.s.EmailAddress="@noRoomListsAvailableMailbox";this.y=new _fm.e([]);this.O();this.c(i)};_adr.K.prototype={q:null,y:null,C:null,z:null,s:null,u:null,B:!1,w:!1,p:null,x:null,r:null,t:!1,v:function(){if(!this.w||!this.q.c())return!1;var n=this.f()&&!this.r.a()?1:0;return this.q.a().x.length-n>0},l:function(){return this.y},f:function(){return!!this.r&&!this.t},j:function(){return this.w},g:function(n){if(this.w===n)return n;this.w=n;this.D();this.t=!1;if(this.w){this.r=null;if(this.v())this.A();else{this.t=!0;this.c(this.u||this.s);this.q.b().g(this.p)}}else this.q.b().g(null);return n},b:function(){return this.u},e:function(n){if(this.u!==n||!n&&!this.B){this.B=!0;this.u=n;this.g(!1);this.eE("selectedRoomListEmailAddress")}return n},a:function(){return this.p},c:function(n){if(this.p!==n){this.p=n;this.eE("selectedRoomEmailAddress")}return n},n:function(){return this.x},i:function(n){if(this.x!==n){this.x=n;this.eE("SelectedDateRange")}return n},h:function(){return this.r},N:function(n){if(this.r!==n){this.r=n;this.eE("SelectedRoomViewModel")}return n},m:function(){return this.s},o:function(){return!!this.p&&(this.M(this.p,this.u)||this.M(this.p,this.s))},d:function(n){var i=new _a.S;if(this.p){i.b(this.p.EmailAddress);n=!0}if(n)for(var r=this.q.l(),t=0;t<r.a.length;t++)i.b(r.c(t));return i},M:function(n,t){return n&&t&&n.EmailAddress&&t.EmailAddress?_a.F.b(n.EmailAddress)===_a.F.b(t.EmailAddress):_g.n.a(n,t)},R:function(n,t){if(this.p){var i=new _adr.A(this.p,this.z,this.C);i.j(!this.q.c());this.E(i);this.N(i);this.O()}else{this.N(null);this.g(!1)}},Q:function(n,t){this.B&&this.q.g(this.u,this.x);this.f()&&this.E(this.r);if(this.w&&(this.r.a()||this.t))if(this.v()){this.t=!1;this.A();this.D()}else{this.t=!0;this.c(this.u||this.s);this.q.b().g(this.p)}},O:function(){this.y.p.g();this.y.p.a(new _fm.c(_adrs.CalARStrings.C,null,this.C));this.v()&&this.y.p.a(new _fm.c(_adrs.CalARStrings.K,null,this.z))},P:function(){if(this.v()&&(_g.n.a(this.p,this.u)||_g.n.a(this.p,this.s))){this.t=!1;this.A()}else if(this.r){this.r.j(!this.q.c());this.E(this.r);this.r.a()&&this.v()&&this.A()}},E:function(n){this.U(n);this.T(n);this.D()},T:function(n){if(this.v()){var i=n.a()?0:1;var t=this.q.a().x.length-i;t?t===1?n.h(_adrs.CalARStrings.n):n.h(String.format(_adrs.CalARStrings.J,t)):n.h("")}},U:function(n){this.t?n.i(new _adr.d(this.p.EmailAddress,"Busy",_adrs.CalARStrings.BN,!1,"NoError",null)):n.i(this.q.m(this.p,this.x))},S:function(){this.c(null)},A:function(){var t=this.q.d(this.p);var n=this.q.a();t=(t+1+n.x.length)%n.x.length;this.c(n.x[t].b);this.q.b().g(this.p)},D:function(){this.z.c(this.v());this.eE("CanSelectNextAvailableRoom")}};_adr.r=function(n){this.a=n};_adr.r.prototype={a:null,b:function(n,t,i){var f=new _h.l(n.b.a(),n.b.b());var u=null;var r=n.b.M();r&&r.b()>0&&(u=r.a(0).bD.Mailbox);return new _adr.K(i,f,u)},c:function(n,t){var i=new _h.l(n.b.a(),n.b.b());var r=this;return new _adr.y(this.a,t,function(){return new _adr.G},i)}};_adr.u=function(n,t){_adr.u.initializeBase(this);this.b=n;if(t)switch(t.b){case"Free":this.a=_adrs.CalARStrings.Z;break;case"NoData":this.a=_adrs.CalARStrings.N;break;case"Tentative":this.a=_adrs.CalARStrings.q;break;case"WorkingElsewhere":this.a=_adrs.CalARStrings.BR;break;case"OOF":this.a=_adrs.CalARStrings.Q;break;default:this.a=_adrs.CalARStrings.c;break}else this.a=""};_adr.u.prototype={b:null,a:null};_adr.y=function(n,t,i,r){this.B=Function.createDelegate(this,this.R);this.C=Function.createDelegate(this,this.S);this.D=Function.createDelegate(this,this.T);this.A=Function.createDelegate(this,this.Q);_adr.y.initializeBase(this);this.E=n;this.r=t;this.r.k(this.A);this.J=i;this.s=new _j.l;this.t=new _j.l;this.u=0;this.p=new _a.S;this.v={};this.q=r;this.H=new _cc.bl;this.w=new Sys.EventHandlerList};_adr.y.a=function(n,t){if(!t)return-1;var i=n.k(function(n){var i=n;return _g.n.a(t,i.b)});return i===n.x.length?-1:i};_adr.y.prototype={E:null,r:null,J:null,s:null,t:null,p:null,H:null,w:null,u:0,v:null,q:null,z:!1,K:!1,G:null,y:null,x:!1,o:null,e:function(n){this.w.addHandler("DataLoaded",n)},n:function(n){this.w.removeHandler("DataLoaded",n)},c:function(){return this.x},a:function(){return this.t},h:function(){return this.s},j:function(){return this.u},l:function(){return this.p},i:function(){return this.z},N:function(n){if(this.z!==n){this.z=n;this.eE("HasErrorOccurred")}return n},b:function(){return this.r},M:function(n){if(this.o){this.o.T(this.D);this.o.U(this.C);this.o.m(this.B)}this.o=n;if(this.o){this.o.b(this.D);this.o.c(this.C);this.o.a(this.B)}return n},m:function(n,t){this.y&&_g.n.a(this.y,n)||(this.y=n);var r;var i=new _a.S;i.b(n.EmailAddress);this.q=t;r=this.r.b(this.q.a,this.q.b,i,!1);return r[n.EmailAddress]||new _adr.d(n.EmailAddress,"NoData",this.H.a("NoData",null),!1,"NoError",new _a.S)},g:function(n,t){this.x=!1;this.N(!1);this.q=t;if(this.K&&this.U(this.G,n))this.L();else{this.K=!0;this.G=n;this.s.g();this.t.g();this.u=0;this.p.f();this.v={};this.M(this.J());this.o.f=n;this.E.a(this.o)}},d:function(n){return _adr.y.a(this.t,n)},f:function(n){return _adr.y.a(this.s,n)},eG:function(){this.r.p(this.A);_a.gb.prototype.eG.call(this)},U:function(n,t){return!n&&!t?!0:t?_g.n.a(t,n):!1},S:function(n){this.N(!0)},R:function(n){this.M(null)},T:function(n){this.r.l().f();for(var i=0;i<this.o.e.length;i++){var t=this.o.e[i];this.p.b(t.EmailAddress);this.v[t.EmailAddress]=t;this.r.l().b(t.EmailAddress)}this.L()},Q:function(n){this.L()},L:function(){var n=null;if(this.p.a.length)if(this.r.o(this.q.a,this.q.b,this.p,!0)){n=this.r.b(this.q.a,this.q.b,this.p,!1);this.O(n)}else this.x=!1;else{n={};this.O(n)}},O:function(n){this.t.g();this.s.g();this.u=0;for(var u=[],f=[],e=0,i=0;i<this.p.a.length;i++){var t=n[this.p.c(i)];var r=this.v[this.p.c(i)];if(t&&t.b!=="Free"){Array.add(u,new _adr.u(r,t));t.b==="NoData"&&e++}else Array.add(f,new _adr.u(r,t))}this.s.j(u);this.t.j(f);this.u=e;this.P()},P:function(){_j.e.a(_a.a.G,"Firing Room Data Loaded {0}",this.p.toString());this.x=!0;var n=this.w.getHandler("DataLoaded");n&&n()}};_adr.A=function(n,t,i){_adr.A.initializeBase(this);this.c=n;this.g=t;this.f=i};_adr.A.prototype={c:null,g:null,f:null,b:null,d:null,e:!1,i:function(n){if(this.b!==n){this.b=n;this.eR("FreeBusyStatus","IsBusy","DisplayStatus")}return n},a:function(){return this.b.e()},h:function(n){if(this.d!==n){this.d=n;this.eE("SelectNextAvailableRoomLabel")}return n},j:function(n){if(this.e!==n){this.e=n;this.eE("ShowLoadingMessage")}return n}};_adr.k=function(n,t,i,r){this.l=Function.createDelegate(this,this.G);this.m=Function.createDelegate(this,this.H);this.u=Function.createDelegate(this,this.w);_adr.k.initializeBase(this,["SelectARoomList",i]);this.n=n;this.g=t;this.r=r;this.j=new _j.l;this.q=new _j.g(this.u,_a.a.G)};_adr.k.prototype={n:null,g:null,r:null,j:null,q:null,C:function(){var n=new _j.l;n.a(new _ff.d(this.z,_adrs.CalARStrings.t,null,!0,!1));n.a(new _ff.d(this.q,_u.c.r,null,!1,!1));return n},D:function(){return!!this.g.a()&&!this.f.b()},v:function(){return this.h&&!this.p},J:function(){if(this.f.b()){_a.c.c(_a.a.x,"RoomListSelectionChanged");this.g.f(this.f.b().Name);this.g.e(this.f.b().EmailAddress);_h.f.a(this.g.c(),this.n);this.i("SelectARoom")}},x:function(){this.o(!1);if(this.D()){_a.c.c(_a.a.x,"RoomListAlreadySelected");var n=new _g.f;n.Name=this.g.b();n.EmailAddress=this.g.a();this.f.e(n);this.i("SelectARoom")}else if(this.v()){_a.c.c(_a.a.x,"ServerHasNoRoomLists");this.f.e(null);this.i("SelectARoom")}else{_a.c.c(_a.a.x,"NatigateToRoomListForm");this.E()}},y:function(){},E:function(){if(!this.h){var n=this.r();n.b(this.m);n.c(this.l);this.n.a(n)}},G:function(n){var t=n;t.T(this.m);t.U(this.l);this.o(!0)},H:function(n){var t=n;t.T(this.m);t.U(this.l);this.j.j(t.e);this.bi(this.j.x.length);if(this.f.b())for(var u=t.e,f=u.length,i=0;i<f;++i){var r=u[i];if(r.EmailAddress===this.f.b().EmailAddress){this.f.e(r);break}}this.A(!0);if(this.v()){this.f.e(null);this.i("SelectARoom")}},w:function(){this.o(!1);this.i(null)}};_adr.g=function(n,t,i){this.bo=Function.createDelegate(this,this.bR);this.V=Function.createDelegate(this,this.bH);this.U=Function.createDelegate(this,this.br);this.Y=Function.createDelegate(this,this.bJ);this.W=Function.createDelegate(this,this.bs);this.X=Function.createDelegate(this,this.bI);this.bk=Function.createDelegate(this,this.bz);this.bl=Function.createDelegate(this,this.bA);this.bm=Function.createDelegate(this,this.bK);this.bn=Function.createDelegate(this,this.bL);this.bj=Function.createDelegate(this,this.by);_adr.g.initializeBase(this,["SelectARoom",n]);this.g=t;this.r=new _j.g(this.bj,_a.a.G);this.u=new _j.g(this.bn,_a.a.G);this.ba=new _j.g(this.bm,_a.a.G);this.bd=new _j.g(this.bl,_a.a.G);this.be=new _j.g(this.bk,_a.a.G);this.f.apcl("selectedRoomListEmailAddress",this.X);this.f.apcl("selectedRoomEmailAddress",this.W);this.O=i};_adr.g.prototype={g:null,u:null,ba:null,bd:null,be:null,r:null,O:!1,j:null,l:null,q:!1,H:!1,D:!1,E:!1,w:!1,G:!1,C:!1,P:null,J:null,K:null,v:function(n){if(this.H!==n){this.H=n;this.eE("NoAvailableRoomsLabelHidden")}return n},M:function(n){if(this.D!==n){this.D=n;this.eE("HasNoRoomsAvailable")}return n},N:function(n){if(this.E!==n){this.E=n;this.eE("HasNoRoomsInDirectory")}return n},bc:function(n){if(this.w!==n){this.w=n;this.eE("ShowBusyRooms")}return n},bp:function(){return this.C&&this.bq()},bP:function(n){if(this.P!==n){this.P=n;this.eE("ShowBusyRoomsLabel")}return n},bu:function(n){if(this.J!==n){this.J=n;this.eE("NoRoomAvailableLabel")}return n},bM:function(n){if(this.K!==n){this.K=n;this.eE("SelectAnyRoomLabelText")}return n},Z:function(){return!0},n:function(){return this.g.a()},m:function(){return this.g.h()},bD:function(){return this.g.j()},bN:function(n){if(this.j!==n&&(this.f.a()?this.f.a().EmailAddress:null)!==n.b.EmailAddress){this.j=n;this.l=null;this.eI("SelectedBusyRoom","SelectedFreeRoom");this.f.g(!1);this.f.c(n?n.b:null)}return n},bO:function(n){if(this.l!==n&&(this.f.a()?this.f.a().EmailAddress:null)!==n.b.EmailAddress){this.l=n;this.j=null;this.eI("SelectedFreeRoom","SelectedBusyRoom");this.f.g(!1);this.f.c(n?n.b:null)}return n},bQ:function(n){if(this.q!==n){this.q=n;this.eE("ShowSelectARoomListButton")}return n},bb:function(n){if(this.G!==n){this.G=n;this.eE("HideListOfAvailableRooms")}return n},bB:function(){return this.f.b()?String.format(_adrs.CalARStrings.BJ,this.f.b().Name):_adrs.CalARStrings.Bb},bC:function(){var n=new _j.l;n.a(new _ff.d(this.z,_adrs.CalARStrings.t,null,!0,!1));n.a(new _ff.d(this.r,_u.c.r,null,!1,!1));return n},bE:function(){var n=new _j.l;n.a(new _ff.d(this.r,_adrs.CalARStrings.B,null,!0,!1));this.q&&n.a(new _ff.d(this.u,_adrs.CalARStrings.W,null,!1,!1));return n},bF:function(){var n=new _j.l;this.q&&n.a(new _ff.d(this.u,_adrs.CalARStrings.W,null,!1,!1));n.a(new _ff.d(this.r,_u.c.r,null,!0,!1));return n},bq:function(){return!0},L:function(n){if(this.C!==n){this.C=n;this.eE("CanShowBusyRooms")}return n},eG:function(){this.f.rpcl("selectedRoomListEmailAddress",this.X);this.f.rpcl("selectedRoomEmailAddress",this.W);this.g.dispose();_a.gb.prototype.eG.call(this)},x:function(){this.bQ(!!this.f.b());this.A(!1);this.bc(!1);this.v(!1);this.M(!1);this.N(!1);this.L(!1);this.bb(!0);this.f.apcl("selectedRoomEmailAddress",this.Y);this.g.e(this.U);this.g.apcl("HasErrorOccurred",this.V);this.g.a().e(this.bo);this.bG()},y:function(){this.f.rpcl("selectedRoomEmailAddress",this.Y);this.g.n(this.U);this.g.rpcl("HasErrorOccurred",this.V)},bv:function(){var n=this.bt(_adrs.CalARStrings.b);this.bu(this.f.b()?String.format(n,this.f.b().Name):_adrs.CalARStrings.BN)},bt:function(n){var t=_adrs.CalARStrings.b;this.bD()===this.m().x.length&&(t=_adrs.CalARStrings.I);return t},bG:function(){this.h?this.br():this.g.g(this.f.b(),this.f.n())},bH:function(n,t){this.o(this.g.i())},br:function(){this.A(!0);this.bi(this.n().x.length+this.m().x.length);this.v(this.n().x.length>0);this.L(this.m().x.length>0);this.M(this.p>0&&!this.n().x.length);this.N(this.R());this.bP(this.f.b()?String.format(_adrs.CalARStrings.f,this.f.b().Name):_adrs.CalARStrings.BG);this.bv();this.bb(this.R())},bJ:function(n,t){this.i(null)},by:function(){this.o(!1);this.M(!1);this.N(!1);this.i(null)},bL:function(){this.o(!1);this.M(!1);this.N(!1);this.i("SelectARoomList")},bK:function(){this.i(null);this.f.g(!0)},bA:function(){this.bc(!0);this.L(!1);this.O?this.v(!0):this.v(this.n().x.length>0)},bz:function(){this.bc(!1);this.L(this.m().x.length>0);this.bb(!1);this.v(this.n().x.length>0)},bI:function(n,t){this.bM(this.f.b()?String.format(_adrs.CalARStrings.BY,this.f.b().Name):_adrs.CalARStrings.o);this.A(!1)},bs:function(n,t){if(!this.f.f()&&(this.l||this.j)){this.l=null;this.j=null}else{var i=this.g.d(this.f.a());if(i>=0){this.l=this.n().x[i];this.j=null}else{i=this.g.f(this.f.a());if(i>=0){this.j=this.m().x[i];this.l=null}}}this.eI("SelectedBusyRoom","SelectedFreeRoom")},bR:function(n,t){this.bs(null,null)}};_adr.L=function(n,t,i){_adr.L.initializeBase(this,[n,t,i])};_adr.L.prototype={Z:function(){return!1},bq:function(){return!1},bv:function(){var n=this.bt(_adrs.CalARStrings.X);this.bu(this.f.b()?String.format(n,this.f.b().Name):_adrs.CalARStrings.L)}};_adr.j=function(n){this.d=Function.createDelegate(this,this.f);this.c=Function.createDelegate(this,this.g);_adr.j.initializeBase(this,[n]);this.y("AddRoomView")};_adr.j.prototype={b:0,a:null,h:function(n){if(n!==this.b){this.b=n;this.bw("AddRoomPopupHorizontalAlignment")}return n},H:function(){_j.c.prototype.H.call(this);if(this.B){this.a=this.B.a("MenuPopup");this.a.bd(this.c);_j.k.b(this.a.z,"keydown",this.d)}else this.e()},bx:function(){this.e();_j.c.prototype.bx.call(this)},g:function(n,t){if(this.a.b()){var i=this.a.z;i.firstChild.focus()}},e:function(){if(this.a){_j.k.c(this.a.z,"keydown");this.a.bP(this.c);this.a.dispose();this.a=null}},f:function(n){var t=this.a.z;if(t&&n.a()===9)if(n.g()&&n.b()===t.firstChild){this.a.a(!1);n.c()}else n.g()||n.b()!==t.lastChild||this.a.a(!1)}};_adr.n=function(n,t,i){_adr.n.initializeBase(this,[n,t,i])};_adr.n.prototype={f:!1,A:function(){return this.f},q:function(n){var t=_fce.v.prototype.q.call(this,n);var i=t.y;this.A()&&(i=_j.x.a(n.z).documentElement.clientHeight-t.y+_j.k.n(this.a.z,!1));return new Sys.UI.Point(t.x,i)}};_adr.o=function(n){this.c=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.g);this.d=Function.createDelegate(this,this.j);_adr.o.initializeBase(this,[n]);this.y("SelectARoomListStepView")};_adr.o.prototype={f:null,b:null,a:null,H:function(){_j.c.prototype.H.call(this);if(this.B){this.f=this.B.a("scrollRegion");this.b=this.B.a("roomslist")}},G:function(){_j.c.prototype.G.call(this);this.b.apcl("UserActionTaken",this.d);this.g(this,null);_j.i.f(this.b.z)&&this.b.R()},bx:function(){this.b.rpcl("UserActionTaken",this.d);_j.c.prototype.bx.call(this)},Y:function(){_j.i.prototype.Y.call(this);if(!this.V()){this.a.rpcl("IsActive",this.e);this.a.rpcl("IsDataLoaded",this.c);return}this.a=this.V();this.a.apcl("IsActive",this.e);this.a.apcl("IsDataLoaded",this.c)},j:function(n,t){this.a&&this.a.J()},i:function(n,t){this.b.be(this.a.f.b());this.g(n,t)},g:function(n,t){if(!this.bo()&&this.a.h){var i=0;this.a.f.b()&&(i=this.h(this.a.f.b()));this.f.f(i)}},h:function(n){var i=this.a.p;var t=this.a.j.m(n);return Math.floor(t/i*100)}};_adr.p=function(n){this.c=Function.createDelegate(this,this.k);this.b=Function.createDelegate(this,this.j);_adr.p.initializeBase(this,[n]);this.y("SelectARoomStepView")};_adr.p.prototype={f:null,a:null,e:!1,d:null,h:function(n){if(this.e!==n){this.e=n;this.bw("ShowSeparatorLine")}return n},H:function(){_j.c.prototype.H.call(this);if(this.B){this.f=this.B.a("scrollRegion");this.d=this.B.a("roomlist")}},G:function(){_j.c.prototype.G.call(this);_j.i.f(this.d.z)&&this.d.R()},Y:function(){_j.i.prototype.Y.call(this);if(!this.V()){this.a.rpcl("IsActive",this.b);this.a.rpcl("IsDataLoaded",this.b);this.a.rpcl("CanShowBusyRooms",this.c);this.a.rpcl("ShowSelectARoomListButton",this.c);return}this.a=this.V();this.h(this.g());this.a.apcl("IsActive",this.b);this.a.apcl("IsDataLoaded",this.b);this.a.apcl("CanShowBusyRooms",this.c);this.a.apcl("ShowSelectARoomListButton",this.c)},j:function(n,t){if(!this.bo()&&this.a.h){var i=0;this.a.f.a()&&(i=this.i(this.a.f.a()));this.f.f(i)}},i:function(n){var i=this.a.n().x.length+1;var t=this.a.g.d(n);if(this.a.w){t=t<0?this.a.g.f(n):t+this.a.m().x.length;i=i+this.a.m().x.length}t<0&&(t=0);return Math.floor(t/i*100)},k:function(n,t){this.h(this.g())},g:function(){return this.a.bp()||this.a.Z()||this.a.q}};_adr.e=function(n,t){_adr.e.initializeBase(this,[n,t]);this.a=t;this.bd=!0;this.fP=t.a()==="Mouse";this.ce(!1)};_adr.e.prototype={a:null,it:function(n){},eD:function(n){var t=_fce.a.prototype.eD.call(this,n);t.A(0);return t},bB:function(){if(!this.a.t())return _j.i.prototype.bB.call(this);var i=new _fc.c;i.l=this.dO();i.j("UPARROW");var r=new _fc.c;r.l=this.dN();r.j("DOWNARROW");var u=new _fc.g;var t=new _fc.c;var n=this;t.l=new _j.g(function(){if(n.bQ()){n.be(n.bQ());n.bw("UserActionTaken")}},this.J());t.j("ENTER");u.a([i,r,t]);return _j.i.prototype.bB.call(this).concat(u)}};_adr.a=function(){};_adr.a.$$cctor=function(){_adr.a._I()};_adr.a.bj=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button autoid=\"_adr_0\" type='button' class='_adr_3 ms-fwt-r'></button> <div class='ms-bg-color-white'></div> </div><div>  <div class='_adr_4 ms-font-weight-regular ms-font-color-neutralPrimary'></div>  <div class='hiddenTabStop'></div> </div><div> <div></div> </div><div> <div class='_adr_7'> <span class='_adr_9 _adr_a'></span> </div> </div><div> <span class='_adr_8'></span> <span class='_adr_8'></span> <div class='_adr_5 ms-bg-color-white'> <div class='_adr_6'></div> </div>  </div><div> <button autoid=\"_adr_1\" type='button' class='_adr_p ms-font-weight-regular'></button> <button autoid=\"_adr_2\" type='button' class='_adr_p ms-font-weight-regular'></button> </div><div> <span></span> </div><div> <span class='_adr_o ms-font-weight-regular ms-font-color-themePrimary'></span>  <div class='_adr_k ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div></div> </div><div> <span class='_adr_o ms-font-weight-regular ms-font-color-themePrimary'></span> <div></div> </div><div> <div class='_adr_g ms-font-weight-regular ms-font-color-neutralPrimary _adr_h'> <span autoid=\"_adr_7\" class='_adr_r _adr_h'></span> <span class='_adr_q'></span> </div> </div><div> <div class='borderBottom'></div> <div class='_adr_l ms-font-weight-regular'></div> <span class='_adr_j ms-font-weight-regular ms-font-color-neutralPrimary'></span> <span autoid=\"_adr_3\" class='_adr_j ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_adr_m'> <div class='_adr_c'>   <div class='_adr_e'></div>  <div class='_adr_e _adr_f'></div> </div> <button autoid=\"_adr_4\" type='button' class='_adr_i ms-font-weight-regular ms-font-color-neutralPrimary'></button> <button autoid=\"_adr_5\" type='button' class='_adr_i ms-font-weight-regular ms-font-color-neutralPrimary'></button> <button autoid=\"_adr_6\" type='button' class='_adr_i ms-font-weight-regular ms-font-color-neutralPrimary'></button> </div>  </div><div> <div class='_adr_s'> <span class='_adr_t ms-font-weight-semilight ms-font-color-neutralPrimary'></span> <div class='_adr_x ms-font-weight-regular'></div> <span class='_adr_u ms-font-weight-regular ms-font-color-neutralTertiary'></span> <button autoid=\"_adr_8\" type='button' class='_adr_v ms-font-weight-regular ms-font-color-themePrimary'></button> </div> <button autoid=\"_adr_9\" type='button' class='_adr_w'></button> </div><div> <span class='_adr_E ms-font-weight-semilight ms-font-color-themePrimary'></span> <div></div> </div><div> <div class='_adr_D ms-font-weight-regular ms-font-color-neutralPrimary'> <span class='_adr_G'></span> <span></span> </div> </div><div> <span class='_adr_E ms-font-weight-semilight ms-font-color-themePrimary'></span> <div class='_adr_y _adr_z'>   <div></div> </div>  <div></div>  <div></div>  <div></div> <div class='_adr_C'> <button type='button' class='_adr_F'></button> </div>  </div><div> <span class='_adr_L ms-font-weight-semilight ms-font-color-themePrimary'></span> <div></div> </div><div> <div class='_adr_K ms-font-weight-regular ms-font-color-neutralPrimary'> <span></span> </div> </div><div> <span class='_adr_L ms-font-weight-semilight ms-font-color-themePrimary'></span> <div class='_adr_I _adr_J'> <div></div> </div>  <div></div>  </div>";_j.i.a().appendChild(n);return n};_adr.a.O=function(n){return n.p};_adr.a.bu=function(n){return n.i};_adr.a.P=function(n){return n.f};_adr.a.N=function(n){return n.a()};_adr.a.C=function(n){return n.b()};_adr.a.br=function(n){return n.b()};_adr.a.bm=function(n){return n.bY};_adr.a.E=function(n){return n.X};_adr.a.bP=function(n){return _adr.j.isInstanceOfType(n)?n.b:null};_adr.a.bQ=function(n){return _adr.n.isInstanceOfType(n)?n.f:null};_adr.a.bw=function(n){return n.e};_adr.a.w=function(n){return n.cT()};_adr.a.L=function(n){return n.V()};_adr.a.i=function(n){return n.e()};_adr.a.j=function(n){return n.B};_adr.a.x=function(n){return n.t};_adr.a.Z=function(n){return n.j};_adr.a.Q=function(n){return n.f};_adr.a.S=function(n){return n.b()};_adr.a.k=function(n){return n.x()};_adr.a.bN=function(n){return n.be};_adr.a.p=function(n){return n.O};_adr.a.G=function(n){return n.w};_adr.a.bf=function(n){return n.bd};_adr.a.bH=function(n){return n.J};_adr.a.bG=function(n){return n.H};_adr.a.U=function(n){return n.b};_adr.a.y=function(n){return n.a};_adr.a.bB=function(n){return n.bB()};_adr.a.bv=function(n){return n.R()};_adr.a.q=function(n){return n.e};_adr.a.bb=function(n){return n.G};_adr.a.ba=function(n){return n.n()};_adr.a.be=function(n){return n.l};_adr.a.bA=function(n){return n.m()};_adr.a.bL=function(n){return n.j};_adr.a.bg=function(n){return n.P};_adr.a.bC=function(n){return n.bp()};_adr.a.bc=function(n){return n.K};_adr.a.bK=function(n){return n.ba};_adr.a.bM=function(n){return n.Z()};_adr.a.bd=function(n){return n.u};_adr.a.H=function(n){return n.q};_adr.a.bx=function(n){return n.c.Name};_adr.a.Y=function(n){return n.e};_adr.a.by=function(n){return n.b.d};_adr.a.X=function(n){return n.d};_adr.a.W=function(n){return n.g};_adr.a.bq=function(n){return n.b};_adr.a.V=function(n){return n.f};_adr.a.bD=function(n){return n.bC()};_adr.a.F=function(n){return n.r};_adr.a.bI=function(n){return n.bE()};_adr.a.bE=function(n){return n.D};_adr.a.bJ=function(n){return n.bF()};_adr.a.bF=function(n){return n.E};_adr.a.bz=function(n){return n.C()};_adr.a.g=function(n,t){n.bl(t)};_adr.a.h=function(n,t){n.j(t)};_adr.a.f=function(n,t){n.T(t)};_adr.a.M=function(n,t){n.ba(t)};_adr.a.bs=function(n,t){n.c(t)};_adr.a.n=function(n,t){n.a(t)};_adr.a.bt=function(n,t){n.d(t)};_adr.a.bn=function(n,t){n.bY=t};_adr.a.bo=function(n,t){n.c(t)};_adr.a.bp=function(n,t){n.b=t};_adr.a.bR=function(n,t){n.f=t};_adr.a.o=function(n,t){n.Q(t)};_adr.a.d=function(n,t){n.a(t)};_adr.a.b=function(n,t){n.K(t)};_adr.a.l=function(n,t){n.bj(t)};_adr.a.T=function(n,t){n.e(t)};_adr.a.m=function(n,t){n.be(t)};_adr.a.K=function(n,t){n.b(t)};_adr.a.J=function(n,t){n.d(t)};_adr.a.bh=function(n,t){n.bO(t)};_adr.a.bO=function(n,t){n.bN(t)};_adr.a.bl=function(n,t){n.l(t)};_adr.a.bk=function(n,t){n.m(t)};_adr.a.A=function(n,t){n.l(t)};_adr.a.B=function(n,t){n.m(t)};_adr.a.z=function(n,t){n.d(t)};_adr.a.R=function(n,t){n.o(t)};_adr.a.D=function(n,t){n.j(t)};_adr.a.v=function(){_adr.a.u||(_adr.a.u=new _b.bF);return _adr.a.u};_adr.a.e=function(){_adr.a.r||(_adr.a.r=new _fc.k);return _adr.a.r};_adr.a.I=function(){_adr.a.s||(_adr.a.s=new _fc.n);return _adr.a.s};_adr.a.bi=function(){_adr.a.t||(_adr.a.t=new _fc.l);return _adr.a.t};_adr.a._I=function(){var h="AddRoomView";new _j.d(h,function(){_adr.a.a[h]===undefined&&(_adr.a.a[h]=[[[-1,0,["FindARoomButtonLabel"],[_adr.a.O],null,"Title",null,_adr.a.g,1,null,null,null],[-1,0,["FindARoomButtonLabel"],[_adr.a.O],null,"Text",null,_adr.a.h,1,null,null,null],[-1,0,["ShowFindARoomCommand"],[_adr.a.bu],null,"ClickCommand",null,_adr.a.f,1,null,null,null],[-1,5,["FindARoomViewModel","PopupVisible"],[_adr.a.P,_adr.a.N],null,"ms-font-color-black ms-bg-color-themeLight ms-border-color-themeSecondary:ms-bg-color-neutralLighter",null,null,0,null,null,null]],[[-1,0,["FindARoomViewModel"],[_adr.a.P],null,"DataContext",null,_adr.a.M,1,null,null,null],[0,0,["PopupVisible"],[_adr.a.N],_adr.a.bs,"IsShown",_adr.a.C,_adr.a.n,2,null,null,!1],[0,0,["ResizeCommand"],[_adr.a.br],_adr.a.bt,"ResizeCommand",_adr.a.bm,_adr.a.bn,2,null,null,null]]]);var i=_adr.a.c.childNodes[0].cloneNode(!0);var n=new _fce.l(i.children[1],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.y("FindARoomView");n.x("contextMenuDropShadow");var r=new _adr.n(_j.b.Instance.a(_b.a),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));r.W(_j.f.a(["ContextParent"],[_adr.a.E],null,"AnchorElement",null,_adr.a.bo,1)).W(_j.f.a(["ContextParent","AddRoomPopupHorizontalAlignment"],[_adr.a.E,_adr.a.bP],null,"HorizontalAlignment",null,_adr.a.bp,1,null,null,0)).W(_j.f.a(["ContextParent","UseBottomBasedPositioning"],[_adr.a.E,_adr.a.bQ],null,"UseBottomBasedPositioning",null,_adr.a.bR,0,null,null,!1));n.c(r);var t=new _fc.b(i.children[0]);t.f("ms-font-color-neutralPrimary ms-border-color-neutralTertiary");t.c("ms-font-color-black ms-bg-color-themeLighter ms-border-color-themeSecondary");t.e("ms-font-color-black ms-bg-color-themeSecondary ms-border-color-themeSecondary");return new _j.a(i,[t,n]).l({MenuPopup:n})},"",_adr.s,_adr.j,function(n){return new _adr.j(n)},!1,!1,!1,0,_adr.a.a);var s="FindARoomView";new _j.d(s,function(){_adr.a.a[s]===undefined&&(_adr.a.a[s]=[[[-1,4,null,null,null,"AriaLabel",null,_adr.a.o,0,null,null,null,_adrs.CalARStrings.e],[-1,0,["CurrentStep"],[_adr.a.bw],null,"DataContext",null,_adr.a.M,1,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_adr.a.o,0,null,null,null,_adrs.CalARStrings.BW]]]);var n=_adr.a.c.childNodes[1].cloneNode(!0);var i=new _j.c(n.children[1]);i.A(0);var t=new _n.h(n.children[0],_j.b.Instance.a(_n.d),_j.b.Instance.a(_b.a));t.A(0);return new _j.a(n,[t,i])},"",_adr.x,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_adr.a.a);var o="SelectARoomListStepView._tid2._tid3";new _j.d(o,function(){_adr.a.a[o]===undefined&&(_adr.a.a[o]=[null]);var t=_adr.a.c.childNodes[2].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_adr.k,_adr.e,function(n){return new _adr.e(n,_j.b.Instance.a(_y.a))},!1,!0,!1,0,_adr.a.a);var c="SelectARoomListStepView.RoomListView";new _j.d(c,function(){_adr.a.a[c]===undefined&&(_adr.a.a[c]=[[[-1,5,["HasFocus"],[_adr.a.w],null,"ms-bg-color-themeLight",null,null,1,null,null,null]],[[-1,1,["DataContext"],[_adr.a.L],null,"Text",null,_adr.a.d,1,_adr.a.v(),null,null],[-1,5,["IsSelected"],[_adr.a.i],null,"_adr_b",null,null,1,null,null,null]]]);var n=_adr.a.c.childNodes[3].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[0,0]));var t=new _j.i(n.children[0]);return new _j.a(n,[t,i])},"",_g.f,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_adr.a.a);var v="SelectARoomListStepView._tid2";new _j.d(v,function(){_adr.a.a[v]===undefined&&(_adr.a.a[v]=[[[-1,4,null,null,null,"Text",null,_adr.a.d,0,null,null,null,_adrs.CalARStrings.BU],[-1,0,["ShowLoadingMessage"],[_adr.a.j],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],[[-1,4,null,null,null,"Text",null,_adr.a.d,0,null,null,null,_adrs.CalARStrings.P],[-1,0,["HasErrorOccurred"],[_adr.a.x],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],null,[[-1,4,null,null,null,"AriaLabel",null,_adr.a.o,0,null,null,null,_adrs.CalARStrings.D],[-1,0,["RoomLists"],[_adr.a.Z],null,"DataSource",null,_adr.a.l,1,null,null,null],[-1,0,["DataContext","SelectedRoomListEmailAddress"],[_adr.a.Q,_adr.a.S],_adr.a.T,"SelectedItem",_adr.a.k,_adr.a.m,2,null,null,null]]]);var n=_adr.a.c.childNodes[4].cloneNode(!0);var t=new _adr.e(_j.a.a(n,[2,0]),_j.b.Instance.a(_y.a));t.u("SelectARoomListStepView.RoomListView");t.y("SelectARoomListStepView._tid2._tid3");var u=new _fce.f(n.children[2],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var r=new _fc.a(n.children[1]);r.A(0);var i=new _fc.a(n.children[0]);i.A(0);return new _j.a(n,[i,r,u,t]).l({scrollRegion:u,roomslist:t})},"",_adr.k,_adr.o,function(n){return new _adr.o(n)},!1,!0,!1,0,_adr.a.a);var a="SelectARoomListStepView";new _j.d(a,function(){_adr.a.a[a]===undefined&&(_adr.a.a[a]=[null]);var t=_adr.a.c.childNodes[2].cloneNode(!0);var n=new _adr.o(t.children[0]);n.y("SelectARoomListStepView._tid2");return new _j.a(t,[n])},"",_adr.k,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_adr.a.a);var l="SelectARoomStepView._tid4._tid5";new _j.d(l,function(){_adr.a.a[l]===undefined&&(_adr.a.a[l]=[[[-1,4,null,null,null,"Title",null,_adr.a.g,0,null,null,null,_adrs.CalARStrings.A],[-1,4,null,null,null,"Text",null,_adr.a.h,0,null,null,null,_adrs.CalARStrings.A],[-1,0,["ShowOnlyAvailableRoomsCommand"],[_adr.a.bN],null,"ClickCommand",null,_adr.a.f,1,null,null,null],[-1,0,["ShowAllRoomsButtonEnabled"],[_adr.a.p],null,"IsHidden",null,_adr.a.b,0,_adr.a.e(),null,!0],[-1,5,["ShowBusyRooms"],[_adr.a.G],null,"ms-font-color-neutralPrimary:ms-font-color-themePrimary",null,null,0,null,null,null]],[[-1,4,null,null,null,"Title",null,_adr.a.g,0,null,null,null,_adrs.CalARStrings.BO],[-1,4,null,null,null,"Text",null,_adr.a.h,0,null,null,null,_adrs.CalARStrings.BO],[-1,0,["ShowBusyRoomsCommand"],[_adr.a.bf],null,"ClickCommand",null,_adr.a.f,1,null,null,null],[-1,0,["ShowAllRoomsButtonEnabled"],[_adr.a.p],null,"IsHidden",null,_adr.a.b,0,_adr.a.e(),null,!0],[-1,5,["ShowBusyRooms"],[_adr.a.G],null,"ms-font-color-themePrimary:ms-font-color-neutralPrimary",null,null,0,null,null,null]]]);var n=_adr.a.c.childNodes[5].cloneNode(!0);var i=new _fc.b(n.children[1]);var t=new _fc.b(n.children[0]);return new _j.a(n,[t,i])},"",_adr.g,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_adr.a.a);var i="SelectARoomStepView._tid4._tid6._tid7";new _j.d(i,function(){_adr.a.a[i]===undefined&&(_adr.a.a[i]=[[[-1,0,["NoRoomAvailableLabel"],[_adr.a.bH],null,"Text",null,_adr.a.d,1,null,null,null]]]);var n=_adr.a.c.childNodes[6].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_adr.g,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_adr.a.a);var t="SelectARoomStepView._tid4._tid6";new _j.d(t,function(){_adr.a.a[t]===undefined&&(_adr.a.a[t]=[[[-1,4,null,null,null,"Text",null,_adr.a.d,0,null,null,null,_adrs.CalARStrings.BI],[-1,0,["ShowAllRoomsButtonEnabled"],[_adr.a.p],null,"IsHidden",null,_adr.a.b,0,null,null,!0]],[[-1,0,["NoAvailableRoomsLabelHidden"],[_adr.a.bG],null,"IsHidden",null,_adr.a.b,1,null,null,!0]],null]);var n=_adr.a.c.childNodes[7].cloneNode(!0);var u=new _fce.d(n.children[2]);var i=new _j.c(n.children[1]);i.A(0);i.y("SelectARoomStepView._tid4._tid6._tid7");var r=new _fc.a(n.children[0]);r.A(0);return new _j.a(n,[r,i,u]).l({ListPanel:u})},"",_adr.g,_adr.e,function(n){return new _adr.e(n,_j.b.Instance.a(_y.a))},!1,!0,!1,0,_adr.a.a);var n="SelectARoomStepView._tid4._tid8";new _j.d(n,function(){_adr.a.a[n]===undefined&&(_adr.a.a[n]=[[[-1,4,null,null,null,"Text",null,_adr.a.d,0,null,null,null,_adrs.CalARStrings.g],[-1,0,["ShowAllRoomsButtonEnabled"],[_adr.a.p],null,"IsHidden",null,_adr.a.b,0,null,null,!0]],null]);var t=_adr.a.c.childNodes[8].cloneNode(!0);var r=new _fce.d(t.children[1]);var i=new _fc.a(t.children[0]);i.A(0);return new _j.a(t,[i,r]).l({ListPanel:r})},"",_adr.g,_adr.e,function(n){return new _adr.e(n,_j.b.Instance.a(_y.a))},!1,!0,!1,0,_adr.a.a);var r="SelectARoomStepView.RoomItemView";new _j.d(r,function(){_adr.a.a[r]===undefined&&(_adr.a.a[r]=[[[-1,5,["HasFocus"],[_adr.a.w],null,"ms-bg-color-themeLight",null,null,1,null,null,null]],[[-1,0,["EmailAddress"],[_adr.a.U],null,"Text",null,_adr.a.d,1,_adr.a.v(),null,null],[-1,5,["IsSelected"],[_adr.a.i],null,"_adr_n",null,null,1,null,null,null]],[[-1,0,["DisplayStatus"],[_adr.a.y],null,"Text",null,_adr.a.d,1,null,null,null],[-1,0,["DisplayStatus"],[_adr.a.y],null,"IsHidden",null,_adr.a.b,1,_adr.a.I(),null,!0],[-1,5,["IsSelected"],[_adr.a.i],null,"_adr_n",null,null,1,null,null,null]]]);var n=_adr.a.c.childNodes[9].cloneNode(!0);var u=new _fc.a(_j.a.a(n,[0,1]));var i=new _fc.a(_j.a.a(n,[0,0]));var t=new _j.i(n.children[0]);return new _j.a(n,[t,i,u])},"",_adr.u,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_adr.a.a);var e="SelectARoomStepView._tid4";new _j.d(e,function(){_adr.a.a[e]===undefined&&(_adr.a.a[e]=[[[-1,5,["ShowAllRoomsButtonEnabled"],[_adr.a.p],null,"ms-bg-color-neutralLight:ms-bg-color-themeLight",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_adr.a.K,0,null,null,0,0],[-1,0,["BusyString"],[_adr.a.bB],null,"BusyText",null,_adr.a.J,1,null,null,null],[-1,0,["ShowLoadingMessage"],[_adr.a.j],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],[[-1,4,null,null,null,"Text",null,_adr.a.d,0,null,null,null,_adrs.CalARStrings.BK],[-1,0,["HasErrorOccurred"],[_adr.a.x],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],[[-1,4,null,null,null,"Text",null,_adr.a.d,0,null,null,null,_adrs.CalARStrings.U],[-1,0,["HasNoRoomsFound"],[_adr.a.bv],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],null,[[-1,5,["ShowSeparatorLine"],[_adr.a.q],null,"_adr_d",null,null,1,null,null,null],[-1,5,["ShowSeparatorLine"],[_adr.a.q],null,"ms-border-color-neutralLight",null,null,1,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_adr.a.o,0,null,null,null,_adrs.CalARStrings.Ba],[-1,0,["HideListOfAvailableRooms"],[_adr.a.bb],null,"IsHidden",null,_adr.a.b,1,null,null,!0],[-1,0,["FreeRooms"],[_adr.a.ba],null,"DataSource",null,_adr.a.l,1,null,null,null],[-1,0,["SelectedFreeRoom"],[_adr.a.be],_adr.a.bh,"SelectedItem",_adr.a.k,_adr.a.m,2,null,null,null],[-1,5,["ShowSeparatorLine"],[_adr.a.q],null,"_adr_f",null,null,1,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_adr.a.o,0,null,null,null,_adrs.CalARStrings.Ba],[-1,0,["ShowBusyRooms"],[_adr.a.G],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0],[-1,0,["BusyRooms"],[_adr.a.bA],null,"DataSource",null,_adr.a.l,1,null,null,null],[-1,0,["SelectedBusyRoom"],[_adr.a.bL],_adr.a.bO,"SelectedItem",_adr.a.k,_adr.a.m,2,null,null,null]],[[-1,0,["ShowBusyRoomsLabel"],[_adr.a.bg],null,"Title",null,_adr.a.g,1,null,null,null],[-1,0,["ShowBusyRoomsLabel"],[_adr.a.bg],null,"Text",null,_adr.a.h,1,null,null,null],[-1,0,["ShowBusyRoomsCommand"],[_adr.a.bf],null,"ClickCommand",null,_adr.a.f,1,null,null,null],[-1,0,["CanShowBusyRooms"],[_adr.a.bC],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],[[-1,0,["SelectAnyRoomLabelText"],[_adr.a.bc],null,"Title",null,_adr.a.g,1,null,null,null],[-1,0,["SelectAnyRoomLabelText"],[_adr.a.bc],null,"Text",null,_adr.a.h,1,null,null,null],[-1,0,["SelectAnyRoomCommand"],[_adr.a.bK],null,"ClickCommand",null,_adr.a.f,1,null,null,null],[-1,0,["ShowAnyAvailableOption"],[_adr.a.bM],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],[[-1,4,null,null,null,"Title",null,_adr.a.g,0,null,null,null,_adrs.CalARStrings.BL],[-1,4,null,null,null,"Text",null,_adr.a.h,0,null,null,null,_adrs.CalARStrings.BL],[-1,0,["SelectARoomListCommand"],[_adr.a.bd],null,"ClickCommand",null,_adr.a.f,1,null,null,null],[-1,0,["ShowSelectARoomListButton"],[_adr.a.H],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]]]);var n=_adr.a.c.childNodes[10].cloneNode(!0);var a=new _fc.b(_j.a.a(n,[4,3]));var h=new _fc.b(_j.a.a(n,[4,2]));var c=new _fc.b(_j.a.a(n,[4,1]));var i=new _adr.e(_j.a.a(n,[4,0,1]),_j.b.Instance.a(_y.a));i.u("SelectARoomStepView.RoomItemView");i.y("SelectARoomStepView._tid4._tid8");var t=new _adr.e(_j.a.a(n,[4,0,0]),_j.b.Instance.a(_y.a));t.u("SelectARoomStepView.RoomItemView");t.y("SelectARoomStepView._tid4._tid6");var s=new _fce.f(_j.a.a(n,[4,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var l=new _j.i(n.children[4]);var u=new _fc.a(n.children[3]);u.A(0);var f=new _fc.a(n.children[2]);f.A(0);var r=new _fce.h(n.children[1],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));r.A(0);r.a=6;var o=new _j.c(n.children[0]);o.y("SelectARoomStepView._tid4._tid5");return new _j.a(n,[o,r,f,u,l,s,t,i,c,h,a]).l({scrollRegion:s,roomlist:t})},"",_adr.g,_adr.p,function(n){return new _adr.p(n)},!1,!0,!1,0,_adr.a.a);var f="SelectARoomStepView";new _j.d(f,function(){_adr.a.a[f]===undefined&&(_adr.a.a[f]=[null]);var t=_adr.a.c.childNodes[2].cloneNode(!0);var n=new _adr.p(t.children[0]);n.y("SelectARoomStepView._tid4");return new _j.a(t,[n])},"",_adr.g,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_adr.a.a);var u="SelectedRoomView";new _j.d(u,function(){_adr.a.a[u]===undefined&&(_adr.a.a[u]=[[[-1,0,["DisplayName"],[_adr.a.bx],null,"Text",null,_adr.a.d,1,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_adr.a.K,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_adr.a.J,0,null,null,null,_adrs.CalARStrings.Bb],[-1,0,["ShowLoadingMessage"],[_adr.a.Y],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],[[-1,0,["DisplayStatus"],[_adr.a.by],null,"Text",null,_adr.a.d,1,null,null,null],[-1,0,["ShowLoadingMessage"],[_adr.a.Y],null,"IsHidden",null,_adr.a.b,1,null,null,!0]],[[-1,0,["SelectNextAvailableRoomLabel"],[_adr.a.X],null,"Title",null,_adr.a.g,1,null,null,null],[-1,0,["SelectNextAvailableRoomLabel"],[_adr.a.X],null,"Text",null,_adr.a.h,1,null,null,null],[-1,0,["SelectNextAvailableRoomCommand"],[_adr.a.W],null,"ClickCommand",null,_adr.a.f,1,null,null,null],[-1,0,["SelectNextAvailableRoomCommand","CanExecute"],[_adr.a.W,_adr.a.bq],null,"IsHidden",null,_adr.a.b,1,_adr.a.e(),null,!0]],[[-1,4,null,null,null,"Title",null,_adr.a.g,0,null,null,null,_u.R.LU],[-1,4,null,null,null,"ImageId",null,_adr.a.bl,0,null,null,null,_n.b.a()],[-1,4,null,null,null,"HoveredImageId",null,_adr.a.bk,0,null,null,null,_n.b.b()],[-1,0,["RemoveCommand"],[_adr.a.V],null,"IsHidden",null,_adr.a.b,1,_adr.a.bi(),null,!0],[-1,0,["RemoveCommand"],[_adr.a.V],null,"ClickCommand",null,_adr.a.f,1,null,null,null]]]);var n=_adr.a.c.childNodes[11].cloneNode(!0);var f=new _fc.b(n.children[1]);var e=new _fc.b(_j.a.a(n,[0,3]));var r=new _fc.a(_j.a.a(n,[0,2]));var t=new _fce.h(_j.a.a(n,[0,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));t.a=6;var i=new _fc.a(_j.a.a(n,[0,0]));return new _j.a(n,[i,t,r,e,f])},"",_adr.A,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_adr.a.a)};_adr.b.registerClass("_adr.b",_a.co);_adr.f.registerClass("_adr.f",_a.co);_adr.H.registerClass("_adr.H");_adr.F.registerClass("_adr.F",_h.dq.$$(_cz.ho,_cz.hp));_adr.z.registerClass("_adr.z",_h.dq.$$(_cz.hL,_cz.hM),_cc.ep,_dg.dZ);_adr.G.registerClass("_adr.G",_h.fF);_adr.c.registerClass("_adr.c",_j.R,_adr.S,Sys.IDisposable);_adr.i.registerClass("_adr.i",CalendarsCache);_adr.l.registerClass("_adr.l",_a.bt,_dg.s,_j.bs,Sys.IDisposable,_dg.ee,_g.hC,_dg.dY);_adr.m.registerClass("_adr.m",_a.bt,_dg.s,_j.bs,Sys.IDisposable,_dg.ee,_g.hC,_dg.dY,_cz.b);_adr.D.registerClass("_adr.D",_adr.C.$$(_adr.z));_adr.h.registerClass("_adr.h");_adr.d.registerClass("_adr.d",_a.bt);CalendarAddRoomComponent.registerClass("CalendarAddRoomComponent",null,_a.js,_j.ce);_adr.v.registerClass("_adr.v");_adr.s.registerClass("_adr.s",_a.bt,IAddRoomViewModel);_adr.E.registerClass("_adr.E",_adr.s);_adr.t.registerClass("_adr.t");_adr.N.registerClass("_adr.N",_a.bt,_adr.O,_j.bs,Sys.IDisposable);_adr.x.registerClass("_adr.x",_y.lw,IFindARoomViewModel);_adr.q.registerClass("_adr.q");_adr.K.registerClass("_adr.K",_a.bt,_adr.P,_j.bs,Sys.IDisposable,_adr.R);_adr.r.registerClass("_adr.r");_adr.u.registerClass("_adr.u",_a.bt);_adr.y.registerClass("_adr.y",_a.bt,_j.bs,Sys.IDisposable);_adr.A.registerClass("_adr.A",_a.bt);_adr.k.registerClass("_adr.k",_adr.N);_adr.g.registerClass("_adr.g",_adr.N);_adr.L.registerClass("_adr.L",_adr.g);_adr.j.registerClass("_adr.j",_j.c);_adr.n.registerClass("_adr.n",_fce.v);_adr.o.registerClass("_adr.o",_j.c);_adr.p.registerClass("_adr.p",_j.c);_adr.e.registerClass("_adr.e",_fce.a);_adr.b.b=new _a.e("MergedFreeBusy",String,_adr.b);_adr.b.a=new _a.e("FreeBusyViewType",String,_adr.b);_adr.b.c=new _a.e("Items",_j.l,_adr.b);_adr.b.$$cctor();_adr.f.a=new _a.e("CalendarView",_adr.b,_adr.f);_adr.c.c="OOF";CalendarAddRoomComponent.$$cctor();_adr.s.a=_a.a.G;_adr.a.c=_adr.a.bj();_adr.a.u=null;_adr.a.r=null;_adr.a.s=null;_adr.a.t=null;_adr.a.a={};_adr.a.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.addroom.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.addroom.js'] = (new Date()).getTime();
